![Title PNG "Skill Factory"](./assets/skillfactory_logo.png)

# SkillFactory_Projects
Projects for SkillFactory DST

# Project - Car Price prediction
- Team: **[Eldar Kalachev](https://github.com/ekalachev)**, **[Anna Kostyakova](https://github.com/anna-kostyakova)**
- Team name on Kaggle.com - StackTeam
- **[Kaggle notebook](https://www.kaggle.com/annakostyakova/car-price-prediction)**

### Public score on Kaggle.com - 16.15951

## Задание
Построить модель, которая будет предсказывать стоимость автомобиля по его характеристикам. 

### Описание признаков
- bodyType - тип кузова           
- brand - марка автомобиля               
- car_url - адрес страницы с объявлением              
- color - цвет автомобиля                 
- complectation_dict - словарь с параметрами комплектации авто
- description - описание автомобиля      
- engineDisplacement - объем двигателя    
- enginePower - мощность двигателя       
- equipment_dict - словарь оснащения авто      
- fuelType - тип топлива             
- image - изображение                
- mileage - пробег               
- modelDate - дата выпуска модели             
- model_info - информация о модели
- model_name - название модели            
- name - имя                 
- numberOfDoors - кол-во дверей       
- parsing_unixtime - когда был произведен парсинг данных      
- priceCurrency - валюта        
- productionDate - год производства     
- sell_id               
- super_gen - словарь с дополинтельной информацией             
- vehicleConfiguration - конфигурация транспортного средства  
- vehicleTransmission - трансмиссия   
- vendor - страна-изготовитель               
- Владельцы - кол-во владельцев      
- Владение - период владения              
- ПТС                  
- Привод                
- Руль                  
- Состояние             
- Таможня    

### В результате работы над данными:
- был произведен парсинг данных с auto.ru 
- был произведен разведывательный анализ данных
- созданы новые признаки
- отбраны признаки для модели по значимости
- произведены эксперименты по подбору модели
- произведены эксперименты по стекингу
- подобраны оптимальные гиперпараметры для модели


#### Экспериментальные работы:
Были проведены эксперименты с построением следующих моделей:
- Linear Regression
- Random Forest Regressor
- Extra Trees Regressor
- Decision Tree Regressor
- Kneigbors
- AdaBoost
- GradientBoosting
- XGBoost
- CatBoost

В финальном ноутбуке эксперименты не отражены для оптимизации рабочего пространства.
Наилучшие результаты показали:
- Random Forest, Extra Trees, XGBoost, CatBoost

Также были проведены эксперименты с разной стандартизацией признаков. Оптимальным оказалась выбор StandardScaler.
Дополнительно были проведены эксперименты с введением новых признаков, включая полиноминальные. Однако это ухудшило качество модели, поэтому было принято решение отказаться от данных признаков и не указывать их в финальном ноутбуке.

В рамках стекинга были проведены эксперименты по подбору моделей estimators (до 4 estimators) и мета-модели с разными параметрами, порядком и т.д.
Наилучшие результаты показал указанный в ноутбуке стекинг.

Дополнительно был проведен отбор признаков. Был испробован метод отбора признаков с помощью SelectKBest, однако ручной отбор показал лучшие результаты.

### Вывод
В результате преобразований и в сравнении с наивной моделью мы видим значительные улучшения предсказательной способности нашей модели. 

### Работа в команде
Данный проект готовился в команде из двух участников. Оба участника команды внесли одинаковый вклад в финальный результат команды. Для отработки навыков каждый из членов команды занимался:
- парсингом
- разведывательным анализом данных (очистка данных, работа с выбросами, визуализация)
- генерацией новых признаков, отбором значимых признаков
- написанием функций и проведением экспериментов для улучшения качества модели 
- подбором и настройкой гиперпараметров для модели
- оформлением презентационной работы
